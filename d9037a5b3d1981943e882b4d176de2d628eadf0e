{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "594d68db_8c69b8e6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 31604
      },
      "writtenOn": "2023-06-23T14:05:46Z",
      "side": 1,
      "message": "I\u0027ve been seeing an issue with Pixel 6 series (maybe other devices are affected, too) where after connecting to certain power sources, especially non-computer USB ports, charge_deadline is still not a writable node, same as if there is no power connected. Adding a 1-second delay fixes that, but this change works better, apart from the errors in logcat for the early failed attempts.",
      "revId": "d9037a5b3d1981943e882b4d176de2d628eadf0e",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "788d4c56_046e03d9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 31578
      },
      "writtenOn": "2023-06-23T16:14:19Z",
      "side": 1,
      "message": "Thanks! So if I understand correctly, if the deadline fails to set, it will retry setting the deadline on next battery_changed intent",
      "parentUuid": "594d68db_8c69b8e6",
      "revId": "d9037a5b3d1981943e882b4d176de2d628eadf0e",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e935ca36_4ff443ff",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 31604
      },
      "writtenOn": "2023-06-23T16:23:52Z",
      "side": 1,
      "message": "Yes, that\u0027s my understanding of what\u0027s happening. Here\u0027s what I see in logs, after the additional log lines change 359890. It all happens within a short timeframe.\n\n```\n06-23 12:21:44.043  1000  2631  2631 I LineageHealth: Power connected, start monitoring battery\n06-23 12:21:44.044  1000  2631  2631 I LineageHealth: Current time is 12:21:44 PM\n06-23 12:21:44.044  1000  2631  2631 I LineageHealth: Target time is 10:00:00 PM\n06-23 12:21:44.046  1000  2631  2631 I LineageHealth: Setting charge deadline: Target time: 10:00:00 PM\n06-23 12:21:44.046  1000  2631  2631 I LineageHealth: Setting charge deadline: Deadline (seconds): 34695\n06-23 12:21:44.048  1000   777   777 E vendor.lineage.health-service.default: Failed to write to charging deadline node: Invalid argument\n06-23 12:21:44.051  1000  2631  2631 E LineageHealth: Failed to set charge deadline\n06-23 12:21:44.051  1000  2631  2631 E LineageHealth: java.lang.IllegalStateException: \n[...]\n06-23 12:21:44.053  1000  2631  2631 I LineageHealth: Current time is 12:21:44 PM\n06-23 12:21:44.053  1000  2631  2631 I LineageHealth: Target time is 10:00:00 PM\n06-23 12:21:44.053  1000  2631  2631 I LineageHealth: Setting charge deadline: Current time: 12:21:44 PM\n06-23 12:21:44.053  1000  2631  2631 I LineageHealth: Setting charge deadline: Target time: 10:00:00 PM\n06-23 12:21:44.053  1000  2631  2631 I LineageHealth: Setting charge deadline: Deadline (seconds): 34695\n06-23 12:21:44.054  1000   777   777 E vendor.lineage.health-service.default: Failed to write to charging deadline node: Invalid argument\n06-23 12:21:44.054  1000  2631  2631 E LineageHealth: Failed to set charge deadline\n06-23 12:21:44.054  1000  2631  2631 E LineageHealth: java.lang.IllegalStateException: \n[...]\n06-23 12:21:44.116  1000  2631  2631 I LineageHealth: Current time is 12:21:44 PM\n06-23 12:21:44.116  1000  2631  2631 I LineageHealth: Target time is 10:00:00 PM\n06-23 12:21:44.116  1000  2631  2631 I LineageHealth: Setting charge deadline: Current time: 12:21:44 PM\n06-23 12:21:44.116  1000  2631  2631 I LineageHealth: Setting charge deadline: Target time: 10:00:00 PM\n06-23 12:21:44.116  1000  2631  2631 I LineageHealth: Setting charge deadline: Deadline (seconds): 34695\n06-23 12:21:44.204  1000  2631  2631 I LineageHealth: Current time is 12:21:44 PM\n06-23 12:21:44.205  1000  2631  2631 I LineageHealth: Target time is 10:00:00 PM\n06-23 12:21:44.235  1000  2631  2631 I LineageHealth: Current time is 12:21:44 PM\n06-23 12:21:44.235  1000  2631  2631 I LineageHealth: Target time is 10:00:00 PM\n```",
      "parentUuid": "788d4c56_046e03d9",
      "revId": "d9037a5b3d1981943e882b4d176de2d628eadf0e",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    }
  ]
}